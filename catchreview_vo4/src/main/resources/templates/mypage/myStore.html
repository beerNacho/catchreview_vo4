<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity5"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{/layout/defaultLayout}">
<head>
<meta charset="utf-8">
<th:block layout:fragment="pageCustomCss">
	<link rel="stylesheet" th:href="@{/css/mypage/mypageMain.css}">
</th:block>
</head>

<th:block layout:fragment="content">

	<!-- index 메인 -->
	<section class="container" style="width: 78%;">
		<div class="centerWrap">
			<div id="sectionHead">
				<ul>
					<li><a th:href="@{/}">Home</a> >&nbsp;</li>
					<li><a th:href="@{/mypage}">마이 페이지</a></li>
				</ul>
			</div>
			<article id="topBox">
				<div id="left">
					<p>[[${#authentication.principal.member.uname}]] 님은 Gold 회원등급
						입니다.</p>
				</div>
				<div id="right">
					<ul>
						<a th:href="@{/join/memberUpdate}"><li>내 정보수정</li></a>
						<a th:href="@{/mypage/store}"><li>MY 가게</li></a>
						<a th:href="@{/mypage/point}"><li>포인트</li></a>
						<a th:href="@{/mypage/review}"><li>MY 리뷰</li></a>
					</ul>
				</div>
			</article>
			<article id="middleBox" style="width: 100%">
				<div id="user">
					<img src="../images/common/basicProfile.png"
						style="width: 100px; height: 100px;">
					<div id="setProfile">
						<img src="../images/common/setting.png">
					</div>

					<p>[[${#authentication.principal.member.uname}]]님</p>
					<p>Gold</p>
				</div>
				<div id="userInfo">
					<div class="box">
						<p>전체 리뷰</p>
						<span>20개</span>
					</div>
					<div class="box">
						<p>채택 리뷰</p>
						<span>0개</span>
					</div>
					<div class="box" style="border: 0px;">
						<p style="margin-left: 75px;">획득 포인트</p>
						<span>200P</span>
					</div>
				</div>
			</article>
			<div>
				<h3>등록된 가게 현황</h3>
				<button class="btn btn-default"
					style="float: right; margin-top: 10px; margin-right: 30px;"
					th:onclick="'window.location.href = \'' + @{/store/storeRegist} + '\''">가게
					등록하기</button>
			</div>
			<article id="review" style="width: 100%;">
				<table style="width: 100%;">
					<thead>
						<tr>
							<th style="width: 15%;">가게명</th>
							<th style="width: 15%;">현상금</th>
							<th style="width: 15%;">기간</th>
							<th style="width: 15%;">리뷰현황</th>
							<th style="width: 25%;">주소</th>
							<th style="width: 15%;">비고</th>
						</tr>
					</thead>
					<tbody id="storeTable">
						
					</tbody>
				</table>
				
				
			</article>
		</div>
	</section>
</th:block>

<th:block layout:fragment="pageCustomScript">
	<script th:src="@{/js/mypage/mystore.js}"></script>
	<script th:src="@{/js/store/storeList.js}"></script>
	<script th:inline="javascript">
	
	var id = [[${#authentication.principal.member.id}]];
	
	var obj = {id:id};
	
	alert(id);
	(function(){
		
		// load stores
		storeManager.getAll(obj, printList);
	})();
	
	
	function printList(list){
		var str = "";
		var storeObj;
		for(var i=0; i<list.length; i++){
			storeObj = list[i];
			
			str += "<tr>" +
			"<td>" + storeObj.storeName+ " </td>" +
			"<td>현상금</td>" +
			"<td>기간</td>" +
			"<td>리뷰현황</td>" +
			"<td>" + storeObj.storeAddress1 + " " + storeAddress2 + " </td>" +
			"<td>비고</td>" +
			"</tr>";
		}
		$("#storeTable").html(str);
	}
	</script>
</th:block>

</html>